var 星星 = "#fMap/MapHelper/weather/witch/3#";
var 彩虹 = "#fItem/Etc/0427/04270001/Icon9/0#";
/* ==================
脚本类型: NPC	    
脚本作者：TT111111   
联系方式qq：111111111111
=====================
*/
importPackage(java.util);
importPackage(Packages.client);
importPackage(Packages.server);
importPackage(Packages.tools);
importPackage(Packages.tools.packet);
importPackage(java.lang);
importPackage(Packages.server.quest);
importPackage(Packages.scripting);
importPackage(Packages.handling.channel);
importPackage(Packages.handling);
importPackage(Packages.handling.word);
importPackage(Packages.constants);
var status = 0;
var 感叹号 = "#fUI/UIWindow/Quest/icon0#";
var 美化new = "#fUI/UIWindow/Quest/icon5/1#";
var 圆形 = "#fUI/UIWindow/Quest/icon3/6#";
//var 蓝色角点 = "#fEffect/CharacterEff/1022223/4/0#";
var 蓝色角点 = "#fEffect/CharacterEff/1112915/0/0#";
var 红色箭头 = "#fUI/UIWindow/Quest/icon6/7#";
var 琴符 = "#fEffect/CharacterEff/1003252/0/0#";
var 音符 = "#fEffect/CharacterEff/1032063/0/0#";
var 花 = "#fUI/UIWindow.img/AriantMatch/characterIcon/0#";
var s = "#fUI/StatusBar/BtClaim/normal/0#";
var h = "#fUI/CashShop/CSEffect/effect/1#";
//var 小雪花 = "#fEffect/CharacterEff/1003393/0/0#";
var 花蘑菇 = "#fItem/Pet/5000046/change/1#";
var 萝卜 = "#fItem/Pet/5000048/angry/0#";
var 蓝色角点 = "#fUI/UIWindow.img/PvP/Scroll/enabled/next2#";
var 心 = "#fUI/GuildMark.img/Mark/Etc/00009001/14#";
var 爱心 = "#fEffect/CharacterEff/1022223/4/0#";
var 礼包物品 = "#v1302000#";
var add = "#fEffect/CharacterEff/1112903/0/0#"; //红桃心
var aaa = "#fUI/UIWindow.img/Quest/icon9/0#"; //红色右箭头
var zzz = "#fUI/UIWindow.img/Quest/icon8/0#"; //蓝色右箭头
var sss = "#fUI/UIWindow.img/QuestIcon/3/0#"; //选择道具
var 正方箭头 = "#fUI/Basic/BtHide3/mouseOver/0#";
var 感叹号 = "#fUI/UIWindow/Quest/icon0#";
var 美化new = "#fUI/UIWindow/Quest/icon5/1#";
var 红色箭头 = "#fEffect/CharacterEff/1112908/0/1#"; //彩光3
var ttt1 = "#fEffect/CharacterEff/1062114/1/0#"; //爱心
var 蓝色角点 = "#fUI/UIWindow.img/PvP/Scroll/enabled/next2#";
var 正方箭头 = "#fUI/Basic/BtHide3/mouseOver/0#";
var 爱心 = "#fEffect/CharacterEff/1022223/4/0#";
var 粉爱心 = "#fItem/Etc/0427/04270005/Icon8/1#"; //
var 菊花 = "#fUI/PredictHarmony/card/19#"; //卡片效果菊花
var 笑 = "#fUI/GuildBBS/GuildBBS/Emoticon/Basic/0#"; //笑脸
var 金枫叶 = "#fMap/MapHelper/weather/Maple/2#";
var 红枫叶 = "#fMap/MapHelper/weather/Maple/1#";
var 巫女 = "#fMap/MapHelper/weather/witch/0#"; //巫女
var 气球 = "#fMap/MapHelper/weather/balloon/4#"; //气球
var 射箭 = "#fMap/MapHelper/weather/LoveEffect2/4/0#"; //射箭
var 玫瑰 = "#fMap/MapHelper/weather/rose/0#"; //玫瑰花
var 烟花 = "#fMap/MapHelper/weather/squib/squib1/3#"; //烟花
var 黑水晶 = 4021008;
var 蓝色箭头 = "#fUI/UIWindow/Quest/icon2/7#";
var 红色箭头 = "#fUI/UIWindow/Quest/icon6/7#";
var 圆形 = "#fUI/UIWindow/Quest/icon3/6#";
var 美化new = "#fUI/UIWindow/Quest/icon5/1#";
var 感叹号 = "#fUI/UIWindow/Quest/icon0#";
var 正方箭头 = "#fUI/Basic/BtHide3/mouseOver/0#";
var 忠告 = "#k温馨提示：任何非法程序和外挂封号处理.封杀侥幸心理.";
var 彩虹 = "#fItem/Etc/0427/04270001/Icon9/0#";
var 中条猫 = "#fItem/Etc/0427/04270001/Icon9/0#";
var 猫右 = "#fItem/Etc/0427/04270001/Icon9/0#";
var 猫左 = "#fItem/Etc/0427/04270001/Icon9/0#";
var 幸运草 = "#fItem/Etc/0427/04270001/Icon9/0#";
var 香水 = "#fItem/Etc/0427/04270001/Icon9/0#";
var 皇冠 = "#fUI/UIWindow.img/UserInfo/bossPetCrown#";
var 开 = "#fUI/Basic/CheckBox/0#";   //有框框 无√
var 关 = "#fUI/Basic/CheckBox/1#";   //有框框 有√
var 金币图 = "#fUI/UIWindow/QuestIcon/7/0#";
var 圆圈 = "#fUI/UIWindow/Quest/icon3/0#";
var ll;
var mj;
var zl;
var yq;
var hp;
var mp;
var gj;
var mg;
var wf;
var mf;
var mz;
var hb;
var ys;
var ty;
var 强化物品 = 1112422;
var 材料物品 = 1112421;
var 物品数量 = 0;
var 成功率 = 100;
var 最高等级 = 80;
var 属性 = [4, 4, 4, 5, 4, 4, 4, 4, 4, 4];
var 攻魔a = [4, 4, 4, 5, 4, 4, 4, 4, 4, 4];
var 祝福数量 = 0;
var 枫叶数量 = 0;
var 暗影数量 = 0;
var 强化物品ivid = -1;
var 下一阶id = -1;
var 下一等级 = "";
var 等级规划 = [
    "", "等级1", "等级2", "等级3", "等级4", "等级5", "等级6", "等级7", "等级8", "等级9", "等级10", "等级11", "等级12", "等级13", "等级14", "等级15", "等级16", "等级17"
];
var 进阶数据 = {
    "1072786": {
        "等级0": {
            "HP": 0,
            "MP": 0,
            "四维": 1,
            "攻魔": 0,
            "双防": 0,
            "材料": [
                [
                    4033203,
                    5
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    10
                ],
                [
                    0,
                    250000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级1": {
            "HP": 0,
            "MP": 0,
            "四维": 1,
            "攻魔": 0,
            "双防": 0,
            "材料": [
                [
                    4033203,
                    5
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    10
                ],
                [
                    0,
                    250000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级2": {
            "HP": 0,
            "MP": 0,
            "四维": 1,
            "攻魔": 0,
            "双防": 0,
            "材料": [
                [
                    4033203,
                    5
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    10
                ],
                [
                    0,
                    250000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级3": {
            "HP": 0,
            "MP": 0,
            "四维": 1,
            "攻魔": 0,
            "双防": 0,
            "材料": [
                [
                    4033203,
                    5
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    10
                ],
                [
                    0,
                    250000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级4": {
            "HP": 0,
            "MP": 0,
            "四维": 1,
            "攻魔": 0,
            "双防": 0,
            "材料": [
                [
                    4033203,
                    5
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    10
                ],
                [
                    0,
                    250000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级5": {
            "HP": 0,
            "MP": 0,
            "四维": 2,
            "攻魔": 1,
            "双防": 1,
            "材料": [
                [
                    4033203,
                    20
                ],
                [
                    4000487,
                    1
                ],
                [
                    4500033,
                    40
                ],
                [
                    0,
                    1000000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级6": {
            "HP": 0,
            "MP": 0,
            "四维": 1,
            "攻魔": 0,
            "双防": 0,
            "材料": [
                [
                    4033203,
                    15
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    20
                ],
                [
                    0,
                    550000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级7": {
            "HP": 0,
            "MP": 0,
            "四维": 1,
            "攻魔": 0,
            "双防": 0,
            "材料": [
                [
                    4033203,
                    15
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    20
                ],
                [
                    0,
                    550000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级8": {
            "HP": 0,
            "MP": 0,
            "四维": 1,
            "攻魔": 0,
            "双防": 0,
            "材料": [
                [
                    4033203,
                    15
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    20
                ],
                [
                    0,
                    550000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级9": {
            "HP": 0,
            "MP": 0,
            "四维": 1,
            "攻魔": 0,
            "双防": 0,
            "材料": [
                [
                    4033203,
                    15
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    20
                ],
                [
                    0,
                    550000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级10": {
            "HP": 1,
            "MP": 1,
            "四维": 4,
            "攻魔": 3,
            "双防": 3,
            "材料": [
                [
                    4033203,
                    60
                ],
                [
                    4000487,
                    2
                ],
                [
                    4500033,
                    80
                ],
                [
                    0,
                    2200000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级11": {
            "HP": 0,
            "MP": 0,
            "四维": 0,
            "攻魔": 1,
            "双防": 1,
            "材料": [
                [
                    4033203,
                    25
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    30
                ],
                [
                    0,
                    850000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级12": {
            "HP": 0,
            "MP": 0,
            "四维": 0,
            "攻魔": 1,
            "双防": 1,
            "材料": [
                [
                    4033203,
                    25
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    30
                ],
                [
                    0,
                    850000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级13": {
            "HP": 0,
            "MP": 0,
            "四维": 0,
            "攻魔": 1,
            "双防": 1,
            "材料": [
                [
                    4033203,
                    25
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    30
                ],
                [
                    0,
                    850000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级14": {
            "HP": 0,
            "MP": 0,
            "四维": 0,
            "攻魔": 1,
            "双防": 1,
            "材料": [
                [
                    4033203,
                    25
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    30
                ],
                [
                    0,
                    850000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级15": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 4,
            "双防": 4,
            "材料": [
                [
                    4033203,
                    100
                ],
                [
                    4000487,
                    3
                ],
                [
                    4500033,
                    120
                ],
                [
                    0,
                    3400000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级16": {
            "HP": 0,
            "MP": 0,
            "四维": 0,
            "攻魔": 1,
            "双防": 1,
            "材料": [
                [
                    4033203,
                    35
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    40
                ],
                [
                    0,
                    1150000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级17": {
            "HP": 0,
            "MP": 0,
            "四维": 0,
            "攻魔": 1,
            "双防": 1,
            "材料": [
                [
                    4033203,
                    35
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    40
                ],
                [
                    0,
                    1150000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级18": {
            "HP": 0,
            "MP": 0,
            "四维": 0,
            "攻魔": 1,
            "双防": 1,
            "材料": [
                [
                    4033203,
                    35
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    40
                ],
                [
                    0,
                    1150000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级19": {
            "HP": 0,
            "MP": 0,
            "四维": 0,
            "攻魔": 1,
            "双防": 1,
            "材料": [
                [
                    4033203,
                    35
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    40
                ],
                [
                    0,
                    1150000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级20": {
            "HP": 3,
            "MP": 3,
            "四维": 3,
            "攻魔": 6,
            "双防": 6,
            "材料": [
                [
                    4033203,
                    140
                ],
                [
                    4000487,
                    4
                ],
                [
                    4500033,
                    160
                ],
                [
                    0,
                    4600000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级21": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 2,
            "双防": 2,
            "材料": [
                [
                    4033203,
                    45
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    50
                ],
                [
                    0,
                    1450000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级22": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 2,
            "双防": 2,
            "材料": [
                [
                    4033203,
                    45
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    50
                ],
                [
                    0,
                    1450000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级23": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 2,
            "双防": 2,
            "材料": [
                [
                    4033203,
                    45
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    50
                ],
                [
                    0,
                    1450000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级24": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 2,
            "双防": 2,
            "材料": [
                [
                    4033203,
                    45
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    50
                ],
                [
                    0,
                    1450000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级25": {
            "HP": 4,
            "MP": 4,
            "四维": 4,
            "攻魔": 8,
            "双防": 8,
            "材料": [
                [
                    4033203,
                    180
                ],
                [
                    4000487,
                    5
                ],
                [
                    4500033,
                    200
                ],
                [
                    0,
                    5800000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级26": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 2,
            "双防": 2,
            "材料": [
                [
                    4033203,
                    55
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    60
                ],
                [
                    0,
                    1750000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级27": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 2,
            "双防": 2,
            "材料": [
                [
                    4033203,
                    55
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    60
                ],
                [
                    0,
                    1750000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级28": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 2,
            "双防": 2,
            "材料": [
                [
                    4033203,
                    55
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    60
                ],
                [
                    0,
                    1750000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级29": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 2,
            "双防": 2,
            "材料": [
                [
                    4033203,
                    55
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    60
                ],
                [
                    0,
                    1750000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级30": {
            "HP": 4,
            "MP": 4,
            "四维": 4,
            "攻魔": 9,
            "双防": 9,
            "材料": [
                [
                    4033203,
                    220
                ],
                [
                    4000487,
                    6
                ],
                [
                    4500033,
                    240
                ],
                [
                    0,
                    7000000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级31": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 2,
            "双防": 2,
            "材料": [
                [
                    4033203,
                    65
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    70
                ],
                [
                    0,
                    2050000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级32": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 2,
            "双防": 2,
            "材料": [
                [
                    4033203,
                    65
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    70
                ],
                [
                    0,
                    2050000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级33": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 2,
            "双防": 2,
            "材料": [
                [
                    4033203,
                    65
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    70
                ],
                [
                    0,
                    2050000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级34": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 2,
            "双防": 2,
            "材料": [
                [
                    4033203,
                    65
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    70
                ],
                [
                    0,
                    2050000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级35": {
            "HP": 5,
            "MP": 5,
            "四维": 5,
            "攻魔": 11,
            "双防": 11,
            "材料": [
                [
                    4033203,
                    260
                ],
                [
                    4000487,
                    7
                ],
                [
                    4500033,
                    280
                ],
                [
                    0,
                    8200000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级36": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 3,
            "双防": 3,
            "材料": [
                [
                    4033203,
                    75
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    80
                ],
                [
                    0,
                    2350000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级37": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 3,
            "双防": 3,
            "材料": [
                [
                    4033203,
                    75
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    80
                ],
                [
                    0,
                    2350000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级38": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 3,
            "双防": 3,
            "材料": [
                [
                    4033203,
                    75
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    80
                ],
                [
                    0,
                    2350000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级39": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 3,
            "双防": 3,
            "材料": [
                [
                    4033203,
                    75
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    80
                ],
                [
                    0,
                    2350000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级40": {
            "HP": 6,
            "MP": 6,
            "四维": 6,
            "攻魔": 13,
            "双防": 13,
            "材料": [
                [
                    4033203,
                    300
                ],
                [
                    4000487,
                    8
                ],
                [
                    4500033,
                    320
                ],
                [
                    0,
                    9400000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级41": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 3,
            "双防": 3,
            "材料": [
                [
                    4033203,
                    85
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    90
                ],
                [
                    0,
                    2650000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级42": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 3,
            "双防": 3,
            "材料": [
                [
                    4033203,
                    85
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    90
                ],
                [
                    0,
                    2650000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级43": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 3,
            "双防": 3,
            "材料": [
                [
                    4033203,
                    85
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    90
                ],
                [
                    0,
                    2650000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级44": {
            "HP": 1,
            "MP": 1,
            "四维": 1,
            "攻魔": 3,
            "双防": 3,
            "材料": [
                [
                    4033203,
                    85
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    90
                ],
                [
                    0,
                    2650000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级45": {
            "HP": 7,
            "MP": 7,
            "四维": 7,
            "攻魔": 14,
            "双防": 14,
            "材料": [
                [
                    4033203,
                    340
                ],
                [
                    4000487,
                    9
                ],
                [
                    4500033,
                    360
                ],
                [
                    0,
                    10600000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级46": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 4,
            "双防": 4,
            "材料": [
                [
                    4033203,
                    95
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    100
                ],
                [
                    0,
                    2950000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级47": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 4,
            "双防": 4,
            "材料": [
                [
                    4033203,
                    95
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    100
                ],
                [
                    0,
                    2950000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级48": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 4,
            "双防": 4,
            "材料": [
                [
                    4033203,
                    95
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    100
                ],
                [
                    0,
                    2950000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级49": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 4,
            "双防": 4,
            "材料": [
                [
                    4033203,
                    95
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    100
                ],
                [
                    0,
                    2950000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级50": {
            "HP": 8,
            "MP": 8,
            "四维": 8,
            "攻魔": 16,
            "双防": 16,
            "材料": [
                [
                    4033203,
                    380
                ],
                [
                    4000487,
                    10
                ],
                [
                    4500033,
                    400
                ],
                [
                    0,
                    11800000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级51": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 4,
            "双防": 4,
            "材料": [
                [
                    4033203,
                    105
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    110
                ],
                [
                    0,
                    3250000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级52": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 4,
            "双防": 4,
            "材料": [
                [
                    4033203,
                    105
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    110
                ],
                [
                    0,
                    3250000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级53": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 4,
            "双防": 4,
            "材料": [
                [
                    4033203,
                    105
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    110
                ],
                [
                    0,
                    3250000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级54": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 4,
            "双防": 4,
            "材料": [
                [
                    4033203,
                    105
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    110
                ],
                [
                    0,
                    3250000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级55": {
            "HP": 9,
            "MP": 9,
            "四维": 9,
            "攻魔": 18,
            "双防": 18,
            "材料": [
                [
                    4033203,
                    420
                ],
                [
                    4000487,
                    11
                ],
                [
                    4500033,
                    440
                ],
                [
                    0,
                    13000000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级56": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 4,
            "双防": 4,
            "材料": [
                [
                    4033203,
                    115
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    120
                ],
                [
                    0,
                    3550000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级57": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 4,
            "双防": 4,
            "材料": [
                [
                    4033203,
                    115
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    120
                ],
                [
                    0,
                    3550000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级58": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 4,
            "双防": 4,
            "材料": [
                [
                    4033203,
                    115
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    120
                ],
                [
                    0,
                    3550000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级59": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 4,
            "双防": 4,
            "材料": [
                [
                    4033203,
                    115
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    120
                ],
                [
                    0,
                    3550000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级60": {
            "HP": 9,
            "MP": 9,
            "四维": 9,
            "攻魔": 19,
            "双防": 19,
            "材料": [
                [
                    4033203,
                    460
                ],
                [
                    4000487,
                    12
                ],
                [
                    4500033,
                    480
                ],
                [
                    0,
                    14200000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级61": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 5,
            "双防": 5,
            "材料": [
                [
                    4033203,
                    125
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    130
                ],
                [
                    0,
                    3850000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级62": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 5,
            "双防": 5,
            "材料": [
                [
                    4033203,
                    125
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    130
                ],
                [
                    0,
                    3850000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级63": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 5,
            "双防": 5,
            "材料": [
                [
                    4033203,
                    125
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    130
                ],
                [
                    0,
                    3850000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级64": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 5,
            "双防": 5,
            "材料": [
                [
                    4033203,
                    125
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    130
                ],
                [
                    0,
                    3850000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级65": {
            "HP": 10,
            "MP": 10,
            "四维": 10,
            "攻魔": 21,
            "双防": 21,
            "材料": [
                [
                    4033203,
                    500
                ],
                [
                    4000487,
                    13
                ],
                [
                    4500033,
                    520
                ],
                [
                    0,
                    15400000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级66": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 5,
            "双防": 5,
            "材料": [
                [
                    4033203,
                    135
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    140
                ],
                [
                    0,
                    4150000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级67": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 5,
            "双防": 5,
            "材料": [
                [
                    4033203,
                    135
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    140
                ],
                [
                    0,
                    4150000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级68": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 5,
            "双防": 5,
            "材料": [
                [
                    4033203,
                    135
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    140
                ],
                [
                    0,
                    4150000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级69": {
            "HP": 2,
            "MP": 2,
            "四维": 2,
            "攻魔": 5,
            "双防": 5,
            "材料": [
                [
                    4033203,
                    135
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    140
                ],
                [
                    0,
                    4150000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级70": {
            "HP": 11,
            "MP": 11,
            "四维": 11,
            "攻魔": 23,
            "双防": 23,
            "材料": [
                [
                    4033203,
                    540
                ],
                [
                    4000487,
                    14
                ],
                [
                    4500033,
                    560
                ],
                [
                    0,
                    16600000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级71": {
            "HP": 3,
            "MP": 3,
            "四维": 3,
            "攻魔": 6,
            "双防": 6,
            "材料": [
                [
                    4033203,
                    145
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    150
                ],
                [
                    0,
                    4450000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级72": {
            "HP": 3,
            "MP": 3,
            "四维": 3,
            "攻魔": 6,
            "双防": 6,
            "材料": [
                [
                    4033203,
                    145
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    150
                ],
                [
                    0,
                    4450000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级73": {
            "HP": 3,
            "MP": 3,
            "四维": 3,
            "攻魔": 6,
            "双防": 6,
            "材料": [
                [
                    4033203,
                    145
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    150
                ],
                [
                    0,
                    4450000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级74": {
            "HP": 3,
            "MP": 3,
            "四维": 3,
            "攻魔": 6,
            "双防": 6,
            "材料": [
                [
                    4033203,
                    145
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    150
                ],
                [
                    0,
                    4450000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级75": {
            "HP": 12,
            "MP": 12,
            "四维": 12,
            "攻魔": 24,
            "双防": 24,
            "材料": [
                [
                    4033203,
                    580
                ],
                [
                    4000487,
                    15
                ],
                [
                    4500033,
                    600
                ],
                [
                    0,
                    17800000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级76": {
            "HP": 3,
            "MP": 3,
            "四维": 3,
            "攻魔": 6,
            "双防": 6,
            "材料": [
                [
                    4033203,
                    155
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    160
                ],
                [
                    0,
                    4750000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级77": {
            "HP": 3,
            "MP": 3,
            "四维": 3,
            "攻魔": 6,
            "双防": 6,
            "材料": [
                [
                    4033203,
                    155
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    160
                ],
                [
                    0,
                    4750000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级78": {
            "HP": 3,
            "MP": 3,
            "四维": 3,
            "攻魔": 6,
            "双防": 8,
            "材料": [
                [
                    4033203,
                    155
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    160
                ],
                [
                    0,
                    4750000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级79": {
            "HP": 3,
            "MP": 3,
            "四维": 3,
            "攻魔": 6,
            "双防": 13,
            "材料": [
                [
                    4033203,
                    155
                ],
                [
                    4000487,
                    0
                ],
                [
                    4500033,
                    160
                ],
                [
                    0,
                    4750000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        },
        "等级80": {
            "HP": 13,
            "MP": 13,
            "四维": 13,
            "攻魔": 26,
            "双防": 35,
            "材料": [
                [
                    4033203,
                    620
                ],
                [
                    4000487,
                    16
                ],
                [
                    4500033,
                    640
                ],
                [
                    0,
                    19000000
                ]
            ],
            "绑定材料": [
                4033104,
                4500034,
                4000313
            ]
        }
    }
};
var sels;
var status = -1;
var 当前星级 = -1;
var 小黄星 = "#fItem/Etc/0427/04270001/Icon9/0#";

function start() {

    action(1, 0, 0);
}

function action(mode, type, selection) {

    if (cm.getInventory(1).getItem(1) == null) {
        cm.sendOk("装备栏第一格没有装备");
        cm.dispose();
        return;
    }
    强化物品 = cm.getInventory(1).getItem(1).getItemId();
    if (!进阶数据[强化物品]) {
        cm.sendOk("请把要强化放在装备栏第一格");
        cm.dispose();
        return;
    }
    var itemaa = cm.getInventory(1).getItem(1).copy();
    // 强化物品ivid = itemaa.getInventoryId();
    // // 获取当前等级

    var currentLevel = "等级0";
    if (itemaa.getOwner() != null && itemaa.getOwner() != "") {
        currentLevel = itemaa.getOwner();
    }
    // 获取当前等级数字
    当前星级 = parseInt(currentLevel.replace("等级", ""));
    if (当前星级 < 0 || 当前星级 > 80) {
        cm.sendOk("未知错误00001，请联系管理员。");
        cm.dispose();
        return;
    }
    下一星级 = 当前星级 + 1;
    当前等级 = "等级" + 当前星级;
    下一等级 = "等级" + (当前星级 + 1);
    // cm.sendOk(下一星级+下一等级);
    // cm.dispose();
    // return;
    // // 检查是否达到最高等级
    if (当前星级 >= 80) {
        cm.sendOk("该装备已到达最高等级，无法继续升级。");
        cm.dispose();
        return;
    }


    if (mode == 1) {
        status++;
    } else if (mode == 0) {
        status--;
    } else {
        cm.dispose();
        return;
    }
    if (status == 0) {

        var text = "";
        text += "#k┏━━" + 小黄星 + "━━━┫ 欢迎来到冒险岛 ┣━━━" + 小黄星 + "━━┓#k\r\n\r\n";
        text += "  " + 感叹号 + "[#v" + 强化物品 + "#][#t" + 强化物品 + "#]#b(最多Lv" + 最高等级 + ")#k#n\r\n";
        text += "  " + 感叹号 + "当前强化是 #b#e" + 当前等级 + "#k#n 强化至 #b#e" + 下一等级 + "#k#n\r\n";
        text += "  " + 感叹号 + "强化后属性：";
        var equip = cm.getEquip(强化物品);
        text += 进阶数据[强化物品][下一等级]["HP"] ? "[#rHP+" + (进阶数据[强化物品][下一等级]["HP"] + equip.getHp()) + "]" : "";
        text += 进阶数据[强化物品][下一等级]["MP"] ? "[#rMP+" + (进阶数据[强化物品][下一等级]["MP"] + equip.getMp()) + "]" : "";
        text += 进阶数据[强化物品][下一等级]["四维"] ? "[#r四维+" + (进阶数据[强化物品][下一等级]["四维"] + equip.getInt()) + "]" : "";
        text += 进阶数据[强化物品][下一等级]["攻魔"] ? "[#r攻魔+" + (进阶数据[强化物品][下一等级]["攻魔"] + equip.getWatk()) + "]" : "";
        text += 进阶数据[强化物品][下一等级]["双防"] ? "[#r双防+" + (进阶数据[强化物品][下一等级]["双防"] + equip.getWatk()) + "]" : "";
        text += 进阶数据[强化物品][下一等级]["速度"] ? "[#r速度+" + 进阶数据[强化物品][下一等级]["速度"] + "]" : "";
        text += 进阶数据[强化物品][下一等级]["跳跃"] ? "[#r跳跃+" + 进阶数据[强化物品][下一等级]["跳跃"] + "]" : "";
        text += 进阶数据[强化物品][下一等级]["命中"] ? "[#r命中+" + 进阶数据[强化物品][下一等级]["命中"] + "]" : "";
        text += 进阶数据[强化物品][下一等级]["回避"] ? "[#r回避+" + 进阶数据[强化物品][下一等级]["回避"] + "]" : "";
        text += "#b#k\r\n";
        text += "  " + 感叹号 + "进行强化的放到 [装备栏] 第#r#e1#k#n格#b#k\r\n";
        text += "  " + 感叹号 + "进行强化需要以下材料：#k\r\n";
        text += "  #b#e----------------------------------------#n#k\r\n";
        // cm.sendOk(强化物品 + "," + 当前星级);
        // cm.dispose();
        // return;

        var 进阶需要材料 = 进阶数据[强化物品][下一等级]["材料"];
        var 进阶需要绑定材料 = 进阶数据[强化物品][下一等级]["绑定材料"];
        var 材料齐全 = true;
        for (var i = 0; i < 进阶需要材料.length; i++) {//判定材料扣除材料
            var 背包绑定物品数量 = 0;
            var 需要物品数量 = 进阶需要材料[i][1];
            var 需要物品id = 进阶需要材料[i][0];
            var 绑定物品id = -1;
            if (进阶需要绑定材料[i]) {
                绑定物品id = 进阶需要绑定材料[i];
                背包绑定物品数量 = cm.itemQuantity(绑定物品id);
            }
            var 背包非绑定物品数量 = cm.itemQuantity(需要物品id);
            if (需要物品id > 0) {
                if (背包绑定物品数量 + 背包非绑定物品数量 < 需要物品数量) {
                    材料齐全 = false;
                    cm.setBossLog("需要物品id", 需要物品id, true);
                } 
                if (需要物品数量 > 0) {
                    text += "   " + 圆形 + "需要#v" + 需要物品id + "# #k[#r " + 需要物品数量 + " #k/ " + (背包绑定物品数量 + 背包非绑定物品数量) + " ] " + ((背包绑定物品数量 + 背包非绑定物品数量) >= 需要物品数量 ? "" + 关 + "#g#e满足#k#n" : "" + 开 + "#r#e不足#k#n") + "#d优先扣除绑定材料#k#n\r\n"
                }
            } else if (需要物品id == 0) {
                if (cm.getPlayer().getMeso() < 需要物品数量) {
                    材料齐全 = false;
                }
                text += "   " + 圆形 + "需要#v2140002# #k[#r " + 需要物品数量 + " #k/ " + cm.getPlayer().getMeso() + " ] " + (cm.getPlayer().getMeso() >= 需要物品数量 ? "" + 关 + "#g#e满足#k#n" : "" + 开 + "#r#e不足#k#n") + "#d#k#n\r\n"
            }
        }
        text += "  #b#e----------------------------------------#n#k\r\n"
        if (材料齐全) {
            text += "  #L1#" + zzz + "#b开始强化#l";
        } else {
            text += "   #L2#" + aaa + "#r获取所需材料#l#n#k\r\n"
        }
        //text += "  #L1#" + zzz + "#b开始强化#l      #L2#" + aaa + "#r获取所需材料#l#n#k\r\n"
        cm.sendSimple(text);
    } else if (status == 1) {
        sels = selection;
        if (selection == 1) {
            cm.sendSimple("#b是否要强化#r#r #i" + 强化物品 + "#? \r\n");
        } else if (selection == 2) {
            if (sels == 2) {
                // cm.sendOk(cm.getBossLog("需要物品id") + "获取材料");
                // cm.dispose();
                // return;
                var 需要物品id = cm.getBossLog("需要物品id");
                // cm.sendSimple(需要物品id);
                if (需要物品id == 4500033 || 需要物品id == 4000313) {
                    cm.dispose();
                    cm.openNpc(9130000, "黄金枫叶礼包");
                    return;
                }
                if (需要物品id == 4001084 ||
                    需要物品id == 4001085 ||
                    需要物品id == 4500006 ||
                    需要物品id == 4500007 ||
                    需要物品id == 4500008 ||
                    需要物品id == 4500009 ||
                    需要物品id == 4500010 ||
                    需要物品id == 4500011 ||
                    需要物品id == 4500012 ||
                    需要物品id == 4500013 ||
                    需要物品id == 4500014 ||
                    需要物品id == 4500015 ||
                    需要物品id == 4500016) {
                    cm.dispose();
                    cm.openNpc(9130000, "BOSS材料礼包");
                }
                if (需要物品id == 4033106 ||
                    需要物品id == 4500402 ||
                    需要物品id == 4500403 ||
                    需要物品id == 4500404 ||
                    需要物品id == 4500405 ||
                    需要物品id == 4500406 ||
                    需要物品id == 4500407 ||
                    需要物品id == 4500408 ||
                    需要物品id == 4500409 ||
                    需要物品id == 4500410 ||
                    需要物品id == 4500411 ||
                    需要物品id == 4500412 ||
                    需要物品id == 4500413) {
                    cm.dispose();
                    cm.openNpc(9130000, "鞋子材料礼包");
                    return;
                }
            }
        }

    } else if (status == 2) {
        if (当前星级 >= 最高等级) {
            var itemab = cm.getInventory(1).getItem(1).copy();
            if (itemab.getMatk() != 16 || !下一阶id || 进阶数据[下一阶id]) {
                cm.sendOk("此装备无法进阶");
                cm.dispose();
                return;
            }
            if (!deleteitem(下一阶id, 下一等级)) {
                cm.sendOk("材料不足");
                cm.dispose();
                return;
            }
            if (!cm.removeFromSlot(1, 1, 1, 强化物品)) {
                cm.sendOk("进阶异常，请重试！！");
                cm.dispose();
                return;
            }
            var equip = cm.getEquip(强化物品);
            equip.setStr(equip.getStr() + 进阶数据[强化物品][下一等级]["四维"]);
            equip.setDex(equip.getDex() + 进阶数据[强化物品][下一等级]["四维"]);
            equip.setInt(equip.getInt() + 进阶数据[强化物品][下一等级]["四维"]);
            equip.setLuk(equip.getLuk() + 进阶数据[强化物品][下一等级]["四维"]);
            equip.setHp(equip.getHp() + 进阶数据[强化物品][下一等级]["HP"]);
            equip.setMp(equip.getMp() + 进阶数据[强化物品][下一等级]["MP"]);
            equip.setWatk(equip.getWatk() + 进阶数据[强化物品][下一等级]["攻魔"]);
            equip.setMatk(equip.getMatk() + 进阶数据[强化物品][下一等级]["攻魔"]);
            equip.setWatk(equip.getWatk() + 进阶数据[强化物品][下一等级]["双防"]);
            equip.setMatk(equip.getMatk() + 进阶数据[强化物品][下一等级]["双防"]);
            equip.setOwner(下一等级);
            cm.addFromDrop(equip, true);
            cm.dispose();
            return;

        } else {
            if (!deleteitem(强化物品, 下一等级)) {
                cm.sendOk("材料不足");
                cm.dispose();
                return;
            }
            if (cm.随机数(100) <= 成功率) {
                var statup = new java.util.ArrayList();
                var item = cm.getInventory(1).getItem(1).copy();
                item.setStr(item.getStr() + 进阶数据[强化物品][下一等级]["四维"]);
                item.setDex(item.getDex() + 进阶数据[强化物品][下一等级]["四维"]);
                item.setInt(item.getInt() + 进阶数据[强化物品][下一等级]["四维"]);
                item.setLuk(item.getLuk() + 进阶数据[强化物品][下一等级]["四维"]);
                item.setHp(item.getHp() + 进阶数据[强化物品][下一等级]["HP"]);
                item.setMp(item.getMp() + 进阶数据[强化物品][下一等级]["MP"]);
                item.setWatk(item.getWatk() + 进阶数据[强化物品][下一等级]["攻魔"]);
                item.setMatk(item.getMatk() + 进阶数据[强化物品][下一等级]["攻魔"]);
                item.setWatk(item.getWatk() + 进阶数据[强化物品][下一等级]["双防"]);
                item.setMatk(item.getMatk() + 进阶数据[强化物品][下一等级]["双防"]);
                item.setOwner(下一等级);
                Packages.server.MapleInventoryManipulator.removeFromSlot(cm.getC(), Packages.client.inventory.MapleInventoryType.EQUIP, 1, 1, false);
                Packages.server.MapleInventoryManipulator.addFromDrop(cm.getC(), item, false);
                //cm.itemlaba("『戒指强化』", "玩家 [" + cm.getPlayer().getName() + "] 强化 "+等级规划[(当前星级+1)]+"成功", item, 15);
                cm.sendNext("强化成功");
                status = -1;

            } else {
                cm.sendNext("强化失败");
                status = -1;
            }
        }

    } else {
        //cm.sendNext("#r发生错误: mode : " + mode + " status : " + status);
        cm.dispose();
    }
}





function deleteitem(新物品id, 新等级) {
    var 进阶需要材料 = 进阶数据[新物品id][新等级]["材料"];
    var 进阶需要绑定材料 = 进阶数据[新物品id][新等级]["绑定材料"];
    for (var i = 0; i < 进阶需要材料.length; i++) {//判定材料扣除材料
        var 背包绑定物品数量 = 0;
        var 需要物品数量 = 进阶需要材料[i][1];
        var 需要物品id = 进阶需要材料[i][0];
        var 绑定物品id = -1;
        if (进阶需要绑定材料[i]) {
            绑定物品id = 进阶需要绑定材料[i];
            背包绑定物品数量 = cm.itemQuantity(绑定物品id);
        }
        var 背包非绑定物品数量 = cm.itemQuantity(需要物品id);
        if (需要物品id > 0) {
            if (背包绑定物品数量 + 背包非绑定物品数量 < 需要物品数量) {
                return false;
            } else {
                if (背包绑定物品数量 >= 需要物品数量) {
                    cm.gainItem(绑定物品id, -需要物品数量);
                } else {
                    cm.gainItem(绑定物品id, -背包绑定物品数量);
                    cm.gainItem(需要物品id, 背包绑定物品数量 - 需要物品数量);
                }
            }
        } else if (需要物品id == 0) {
            if (cm.getPlayer().getMeso() < 需要物品数量) {
                return false;
            }
            cm.gainMeso(-需要物品数量);
        }
    }
    return true;
}